(()=>{"use strict";var e=function(e,t,n,a){return new(n||(n=Promise))(function(o,i){function r(e){try{l(a.next(e))}catch(e){i(e)}}function s(e){try{l(a.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(r,s)}l((a=a.apply(e,t||[])).next())})};function t(n){return e(this,void 0,void 0,function*(){if("RECTANGLE"===n.type)return function(e){const t=figma.createRectangle();return t.name=e.name,t.resize(e.width,e.height),void 0!==e.x&&(t.x=e.x),void 0!==e.y&&(t.y=e.y),t.fills=e.fills,void 0!==e.cornerRadius&&(t.cornerRadius=e.cornerRadius),t}(n);if("TEXT"===n.type)return yield function(t){return e(this,void 0,void 0,function*(){const e=yield function(e,t){return n=this,a=void 0,i=function*(){try{return yield figma.loadFontAsync({family:e,style:t}),!0}catch(n){console.warn(`Failed to load font ${e} ${t}, falling back to Inter`);try{return yield figma.loadFontAsync({family:"Inter",style:"Regular"}),!1}catch(e){return console.error("Failed to load fallback font Inter Regular"),!1}}},new((o=void 0)||(o=Promise))(function(e,t){function r(e){try{l(i.next(e))}catch(e){t(e)}}function s(e){try{l(i.throw(e))}catch(e){t(e)}}function l(t){var n;t.done?e(t.value):(n=t.value,n instanceof o?n:new o(function(e){e(n)})).then(r,s)}l((i=i.apply(n,a||[])).next())});var n,a,o,i}(t.fontName.family,t.fontName.style),n=figma.createText();return n.name=t.name,n.fontName=e?t.fontName:{family:"Inter",style:"Regular"},n.characters=t.characters,n.fontSize=t.fontSize,void 0!==t.x&&(n.x=t.x),void 0!==t.y&&(n.y=t.y),void 0!==t.width&&n.resize(t.width,n.height),t.fills&&(n.fills=t.fills),t.textAlignHorizontal&&(n.textAlignHorizontal=t.textAlignHorizontal),t.textAlignVertical&&(n.textAlignVertical=t.textAlignVertical),n})}(n);if("FRAME"===n.type)return yield function(n){return e(this,void 0,void 0,function*(){const e=figma.createFrame();e.name=n.name,e.resize(n.width,n.height),void 0!==n.x&&(e.x=n.x),void 0!==n.y&&(e.y=n.y),n.fills&&(e.fills=n.fills),void 0!==n.cornerRadius&&(e.cornerRadius=n.cornerRadius),n.layoutMode&&"NONE"!==n.layoutMode&&(e.layoutMode=n.layoutMode,void 0!==n.itemSpacing&&(e.itemSpacing=n.itemSpacing),void 0!==n.paddingLeft&&(e.paddingLeft=n.paddingLeft),void 0!==n.paddingRight&&(e.paddingRight=n.paddingRight),void 0!==n.paddingTop&&(e.paddingTop=n.paddingTop),void 0!==n.paddingBottom&&(e.paddingBottom=n.paddingBottom),n.primaryAxisSizingMode&&(e.primaryAxisSizingMode=n.primaryAxisSizingMode),n.counterAxisSizingMode&&(e.counterAxisSizingMode=n.counterAxisSizingMode));for(const a of n.children){const n=yield t(a);e.appendChild(n)}return e})}(n);throw new Error(`Unknown node type: ${n.type}`)})}var n=function(e,t,n,a){return new(n||(n=Promise))(function(o,i){function r(e){try{l(a.next(e))}catch(e){i(e)}}function s(e){try{l(a.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(r,s)}l((a=a.apply(e,t||[])).next())})};function a(e,t,a){return n(this,void 0,void 0,function*(){const n=e.name.toLowerCase(),a=e.characters.toLowerCase();yield figma.loadFontAsync(e.fontName);const i=(t,n,a)=>(e.characters=t,console.log(`âœ… Filled "${e.name}" with "${t}" from manifest.${a}`),{filled:!0,field:n,value:t,source:a});if(o(n,a,["persona name","name","user name"]))return i(t.strategy.persona.name,"Persona Name","strategy.persona.name");if(o(n,a,["persona role","role","job title","position"]))return i(t.strategy.persona.role,"Persona Role","strategy.persona.role");if(o(n,a,["company","organization"]))return i(t.strategy.persona.company,"Company","strategy.persona.company");if(o(n,a,["industry","sector"]))return i(t.strategy.persona.industry,"Industry","strategy.persona.industry");if(o(n,a,["location","city","country"]))return i(`${t.strategy.persona.location}, ${t.strategy.persona.country}`,"Location","strategy.persona.location+country");const r=n.match(/pain\s?point\s?(\d+)/i);if(r){const e=parseInt(r[1])-1;if(t.strategy.persona.painPoints[e])return i(t.strategy.persona.painPoints[e],`Pain Point ${e+1}`,`strategy.persona.painPoints[${e}]`)}const s=n.match(/goal\s?(\d+)/i);if(s){const e=parseInt(s[1])-1;if(t.strategy.persona.goals[e])return i(t.strategy.persona.goals[e],`Goal ${e+1}`,`strategy.persona.goals[${e}]`)}if(o(n,a,["brand name","brand"]))return i(t.brandName,"Brand Name","brandName");if(o(n,a,["headline","tagline","slogan"]))return i(t.strategy.valueProp.headline,"Headline","strategy.valueProp.headline");if(o(n,a,["subheadline","subtitle","description"]))return i(t.strategy.valueProp.subheadline,"Subheadline","strategy.valueProp.subheadline");if(o(n,a,["problem","challenge"]))return i(t.strategy.valueProp.problem,"Problem","strategy.valueProp.problem");if(o(n,a,["solution"]))return i(t.strategy.valueProp.solution,"Solution","strategy.valueProp.solution");if(e.characters.includes("{{")){const n=function(e,t){return e.replace(/\{\{persona\.name\}\}/gi,t.strategy.persona.name).replace(/\{\{persona\.role\}\}/gi,t.strategy.persona.role).replace(/\{\{persona\.company\}\}/gi,t.strategy.persona.company).replace(/\{\{persona\.industry\}\}/gi,t.strategy.persona.industry).replace(/\{\{persona\.location\}\}/gi,t.strategy.persona.location).replace(/\{\{persona\.country\}\}/gi,t.strategy.persona.country).replace(/\{\{brand\.name\}\}/gi,t.brandName).replace(/\{\{value\.headline\}\}/gi,t.strategy.valueProp.headline).replace(/\{\{value\.subheadline\}\}/gi,t.strategy.valueProp.subheadline).replace(/\{\{value\.problem\}\}/gi,t.strategy.valueProp.problem).replace(/\{\{value\.solution\}\}/gi,t.strategy.valueProp.solution).replace(/\{\{value\.outcome\}\}/gi,t.strategy.valueProp.outcome)}(e.characters,t);if(n!==e.characters)return e.characters=n,console.log(`âœ… Filled "${e.name}" with placeholder replacement`),{filled:!0,field:"Placeholder",value:n,source:"placeholder syntax"}}return console.log(`â­ï¸  Skipped "${e.name}" (no match found)`),{filled:!1}})}function o(e,t,n){for(const a of n)if(e.includes(a)||t.includes(a))return!0;return!1}var i=function(e,t,n,a){return new(n||(n=Promise))(function(o,i){function r(e){try{l(a.next(e))}catch(e){i(e)}}function s(e){try{l(a.throw(e))}catch(e){i(e)}}function l(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(r,s)}l((a=a.apply(e,t||[])).next())})};function r(e){const t="string"==typeof e?parseInt(e):e;return t>=700?"Bold":t>=600?"SemiBold":t>=500?"Medium":"Regular"}function s(e){e=e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(e,t,n,a){return t+t+n+n+a+a});const t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?{r:parseInt(t[1],16)/255,g:parseInt(t[2],16)/255,b:parseInt(t[3],16)/255}:{r:0,g:0,b:0}}figma.showUI(__html__,{width:400,height:500}),figma.ui.onmessage=e=>i(void 0,void 0,void 0,function*(){if("generate-personas"===e.type&&figma.notify("Persona generation coming soon to this version!"),"import-manifest"===e.type)try{const{manifest:n,selectedComponents:a}=e;if(figma.ui.postMessage({type:"status",message:"Creating color styles..."}),yield function(e){return i(this,void 0,void 0,function*(){const t=(e,t)=>{const n=figma.createPaintStyle();n.name=e,n.paints=[{type:"SOLID",color:s(t)}]};e.primary&&e.primary.length>0&&e.primary.forEach((e,n)=>{t(`Brand/Primary/${e.name||`Color ${n+1}`}`,e.hex)}),e.secondary&&e.secondary.length>0&&e.secondary.forEach((e,n)=>{t(`Brand/Secondary/${e.name||`Color ${n+1}`}`,e.hex)}),e.accent&&e.accent.length>0&&e.accent.forEach((e,n)=>{t(`Brand/Accent/${e.name||`Color ${n+1}`}`,e.hex)}),e.neutral&&e.neutral.length>0&&e.neutral.forEach((e,n)=>{t(`Brand/Neutral/${e.name||`Color ${n+1}`}`,e.hex)})})}(n.identity.colors),figma.ui.postMessage({type:"status",message:"Creating text styles..."}),yield function(e){return i(this,void 0,void 0,function*(){const t=(e,t,n,a,o)=>i(this,void 0,void 0,function*(){try{yield figma.loadFontAsync({family:t,style:n});const i=figma.createTextStyle();i.name=e,i.fontName={family:t,style:n},i.fontSize=a,o&&(i.lineHeight={value:100*o,unit:"PERCENT"})}catch(t){console.error(`Could not create text style ${e}:`,t)}}),n=e.heading,a=n.weights&&n.weights[0]?r(n.weights[0]):"Bold";try{yield figma.loadFontAsync({family:n.family,style:a});const e=n.sizes;e.h1&&(yield t("Heading/H1",n.family,a,parseInt(e.h1),1.2)),e.h2&&(yield t("Heading/H2",n.family,a,parseInt(e.h2),1.3)),e.h3&&(yield t("Heading/H3",n.family,a,parseInt(e.h3),1.4)),e.h4&&(yield t("Heading/H4",n.family,a,parseInt(e.h4||"24"),1.4))}catch(e){console.error(`Could not load  font ${n.family}`,e),figma.notify(`Could not load font ${n.family}. Using Inter instead.`)}const o=e.body,s=o.weights&&o.weights[0]?r(o.weights[0]):"Regular";try{yield figma.loadFontAsync({family:o.family,style:s});const e=o.sizes;e.base&&(yield t("Body/Base",o.family,s,parseInt(e.base),1.5)),e.small&&(yield t("Body/Small",o.family,s,parseInt(e.small),1.5))}catch(e){console.error(`Could not load font ${o.family}`,e)}})}(n.identity.typography),null==a?void 0:a.brandGuide){figma.ui.postMessage({type:"status",message:"Building Brand Guide..."});const e=function(e){const t=e.identity.colors,n=e.identity.typography,a=[];let o=50;const i=(e,t)=>{var n;a.push({type:"RECTANGLE",name:e.name,width:100,height:100,x:o,y:100,fills:[{type:"SOLID",color:(n=e.hex,3===(n=n.replace("#","")).length&&(n=n[0]+n[0]+n[1]+n[1]+n[2]+n[2]),{r:parseInt(n.substring(0,2),16)/255,g:parseInt(n.substring(2,4),16)/255,b:parseInt(n.substring(4,6),16)/255})}],cornerRadius:8}),a.push({type:"TEXT",name:`${e.name} Label`,characters:`${e.name}\n${e.hex}`,fontSize:12,fontName:{family:"Inter",style:"Regular"},x:o,y:210,fills:[{type:"SOLID",color:{r:.2,g:.2,b:.2}}]}),o+=120};t.primary.forEach((e,t)=>i(e)),t.secondary.forEach((e,t)=>i(e)),t.accent&&t.accent.length>0&&t.accent.forEach((e,t)=>i(e)),a.push({type:"TEXT",name:"Typography Section",characters:"Typography",fontSize:24,fontName:{family:"Inter",style:"Bold"},x:50,y:350,fills:[{type:"SOLID",color:{r:.1,g:.1,b:.1}}]});let r=410;const s=n.heading.sizes;return Object.entries(s).forEach(([e,t],o)=>{a.push({type:"TEXT",name:`Heading ${e}`,characters:`${e.toUpperCase()}: The quick brown fox`,fontSize:Math.min(parseInt(t),36),fontName:{family:n.heading.family,style:"Bold"},x:50,y:r,fills:[{type:"SOLID",color:{r:.1,g:.1,b:.1}}]}),r+=Math.min(parseInt(t),36)+30}),{type:"FRAME",name:"Brand Guide",width:Math.max(o+50,1200),height:r+100,children:a,fills:[{type:"SOLID",color:{r:1,g:1,b:1}}]}}(n),a=figma.createPage();a.name=`Brand Guide - ${n.brandName}`;const o=yield t(e);a.appendChild(o)}if(null==a?void 0:a.landingPage){figma.ui.postMessage({type:"status",message:"Building Landing Page..."});const e=function(e){const t=e.previews.landingPage,n=e.identity.colors.primary[0],a=[];let o=0;const i={type:"FRAME",name:"Hero Section",width:1440,height:600,x:0,y:o,children:[{type:"TEXT",name:"Headline",characters:t.hero.headline,fontSize:48,fontName:{family:"Inter",style:"Bold"},x:120,y:200,width:1200,textAlignHorizontal:"CENTER",fills:[{type:"SOLID",color:{r:.1,g:.1,b:.1}}]},{type:"TEXT",name:"Subheadline",characters:t.hero.subheadline,fontSize:20,fontName:{family:"Inter",style:"Regular"},x:220,y:280,width:1e3,textAlignHorizontal:"CENTER",fills:[{type:"SOLID",color:{r:.4,g:.4,b:.4}}]},{type:"FRAME",name:"CTA Button",width:200,height:50,x:620,y:400,children:[{type:"TEXT",name:"CTA Text",characters:t.hero.cta.primary,fontSize:16,fontName:{family:"Inter",style:"Medium"},x:0,y:15,width:200,textAlignHorizontal:"CENTER",fills:[{type:"SOLID",color:{r:1,g:1,b:1}}]}],fills:n?[{type:"SOLID",color:(r=n.hex,3===(r=r.replace("#","")).length&&(r=r[0]+r[0]+r[1]+r[1]+r[2]+r[2]),{r:parseInt(r.substring(0,2),16)/255,g:parseInt(r.substring(2,4),16)/255,b:parseInt(r.substring(4,6),16)/255})}]:[{type:"SOLID",color:{r:.39,g:.4,b:.95}}],cornerRadius:8}],fills:[{type:"SOLID",color:{r:.98,g:.98,b:.98}}]};var r;a.push(i),o+=600;const s={type:"FRAME",name:"Features Grid",width:1440,height:800,x:0,y:o,children:[],fills:[{type:"SOLID",color:{r:1,g:1,b:1}}]};let l=120,c=100;return t.features.slice(0,6).forEach((e,t)=>{const n={type:"FRAME",name:e.title,width:380,height:250,x:l,y:c,children:[{type:"TEXT",name:"Feature Title",characters:e.title,fontSize:18,fontName:{family:"Inter",style:"Bold"},x:24,y:24,width:332,fills:[{type:"SOLID",color:{r:.1,g:.1,b:.1}}]},{type:"TEXT",name:"Feature Description",characters:e.description,fontSize:14,fontName:{family:"Inter",style:"Regular"},x:24,y:60,width:332,fills:[{type:"SOLID",color:{r:.4,g:.4,b:.4}}]}],fills:[{type:"SOLID",color:{r:.97,g:.97,b:.97}}],cornerRadius:12};s.children.push(n),l+=420,(t+1)%3==0&&(l=120,c+=290)}),a.push(s),o+=800,{type:"FRAME",name:"Landing Page",width:1440,height:o,x:0,y:0,children:a,fills:[{type:"SOLID",color:{r:1,g:1,b:1}}]}}(n),a=figma.createPage();a.name=`Landing Page - ${n.brandName}`;const o=yield t(e);a.appendChild(o),figma.currentPage=a,figma.viewport.scrollAndZoomIntoView([o])}figma.ui.postMessage({type:"success",message:"âœ… Brand System and Components imported successfully!"}),figma.notify("âœ… Import complete!")}catch(e){console.error("Import error:",e),figma.ui.postMessage({type:"error",message:e.message||"Failed to import brand system"})}if("fill-template"===e.type)try{const{manifest:t}=e;figma.ui.postMessage({type:"status",message:"Scanning template..."});const o=yield function(e){return n(this,arguments,void 0,function*(e,t={}){const{currentPageOnly:n=!0,preserveStyles:o=!0}=t;let i=0,r=0;const s=[],l=figma.currentPage,c=l.findAll(e=>"TEXT"===e.type);console.log("\nðŸ” TEMPLATE FILLER - Starting scan..."),console.log(`ðŸ“„ Page: "${l.name}"`),console.log(`ðŸ“ Found ${c.length} text nodes to process\n`);for(const t of c){const n=yield a(t,e);n.filled?(i++,s.push({layerName:t.name,field:n.field,value:n.value,source:n.source})):r++}return console.log("\nðŸ“Š SUMMARY:"),console.log(`âœ… Filled: ${i} fields`),console.log(`â­ï¸  Skipped: ${r} fields`),console.log("\nðŸŽ‰ Template filling complete!\n"),{filled:i,skipped:r,details:s}})}(t);figma.ui.postMessage({type:"status",message:"Filling pain points..."});const i=yield function(e){return n(this,arguments,void 0,function*(e,t="pain points"){const n=figma.currentPage.findOne(e=>e.name.toLowerCase().includes(t)&&"FRAME"===e.type);if(!n)return 0;let a=0;const o=n.findAll(e=>"TEXT"===e.type);for(let t=0;t<Math.min(o.length,e.strategy.persona.painPoints.length);t++){const n=o[t];yield figma.loadFontAsync(n.fontName),n.characters=e.strategy.persona.painPoints[t],a++}return a})}(t);figma.ui.postMessage({type:"status",message:"Filling goals..."});const r=yield function(e){return n(this,arguments,void 0,function*(e,t="goals"){const n=figma.currentPage.findOne(e=>e.name.toLowerCase().includes(t)&&"FRAME"===e.type);if(!n)return 0;let a=0;const o=n.findAll(e=>"TEXT"===e.type);for(let t=0;t<Math.min(o.length,e.strategy.persona.goals.length);t++){const n=o[t];yield figma.loadFontAsync(n.fontName),n.characters=e.strategy.persona.goals[t],a++}return a})}(t),s=o.filled+i+r;figma.ui.postMessage({type:"success",message:`âœ… Filled ${s} fields in template!`}),figma.notify(`âœ… Template filled: ${s} fields updated`)}catch(e){console.error("Template fill error:",e),figma.ui.postMessage({type:"error",message:e.message||"Failed to fill template"})}"close"===e.type&&figma.closePlugin()})})();